SELECT	'01'||lpad(barcode_number,14,'0')||'17'||'010120'||'10'||'LOTE-01' codigo, barcode_number,
		barcode_item_id--, BODEGA_PKG_01.Recupera_Stock(vl_org_cd, barcode_item_id, vl_rubro, vl_localizador) stock
FROM	Syb_Item_Barcodes b 
WHERE	barcode_type = '13';--'13'
	--AND	BODEGA_PKG_01.Recupera_Stock(vl_org_cd, barcode_item_id, vl_rubro, vl_localizador) > 0;

select codigo_bandeja, estado, bdg_codigo, ind_revision_rcm from bandejas where numero = 36211 and lo_codigo = 1 and organization_id = 2;

select  numero, estado, bdg_codigo, (select  count(*)
        from    BANDEJAS ban
        where   ban.numero = sal.numero
            and ban.lo_codigo = sal.lo_codigo
            and ban.organization_id = sal.organization_id) cant
from    SALIDAS_DET_TL sal
where   lo_codigo = 1
    and organization_id = 2
    and (select  count(*)
        from    BANDEJAS ban
        where   ban.numero = sal.numero
            and ban.lo_codigo = sal.lo_codigo
            and ban.organization_id = sal.organization_id) > 5;

update bandejas set estado = 'TR' where numero = 40738 and lo_codigo = 1 and organization_id = 2;
update salidas_det_tl set estado = 'GD' where lo_codigo = 1 and numero = 40738 and organization_id = 2;
update salidas_det_tl set estado = 'GD' where lo_codigo = 1 and numero = 36211 and organization_id = 2 and bdg_codigo in ('Val','Mkt');
commit;